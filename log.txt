üßÆ Device:          CUDA

====================================================================================================
                                 TEMPEST AI - NETWORK CONFIGURATION
====================================================================================================

üìê NETWORK ARCHITECTURE:
   State Size:        171
   Discrete Actions:  44 (joint FIRE/ZAP/SPINNER)

   Shared Trunk:      5 layers
      Layer 1:        171 ‚Üí 512
      Layer 2:        512 ‚Üí 512
      Layer 3:        512 ‚Üí 256
      Layer 4:        256 ‚Üí 256
      Layer 5:        256 ‚Üí 128

   Action Head:       128 ‚Üí 64 ‚Üí 44

   Total Parameters:  591,852
   Trainable:         591,852

‚öôÔ∏è  TRAINING HYPERPARAMETERS:
   Learning Rate:     0.000150
   Batch Size:        1,024
   Gamma (Œ≥):         0.99
   Epsilon (Œµ):       0.5 ‚Üí 0.05 (exploration)
   Memory Size:       1,300,000 transitions
   Target Update:     Every 1000 steps

‚öñÔ∏è  LOSS CONFIGURATION:
   Discrete Loss:     TD (Huber)
   Loss Weight:       1.0
   Max Q-Value Clip:  500.0
   TD Target Clip:    None

üéì EXPERT GUIDANCE:
   Expert Ratio:      50%
   Superzap Gate:     Enabled

üöÄ OPTIMIZATION:
   Gradient Clip:     10.0 (max norm)
   N-Step Returns:    5-step
   Training Workers:  4

‚å®Ô∏è  KEYBOARD CONTROLS:
   [q] Quit           [s] Save Model       [c] Clear Screen
   [o] Override       [e] Expert Mode      [p] Force Epsilon
   [t] Training       [v] Verbose          [h] Hard Target Update
   [7] Dec Expert     [8] Reset Expert     [9] Inc Expert
   [4] Dec Epsilon    [5] Reset Epsilon    [6] Inc Epsilon
   [l] Dec LR         [L] Inc LR           [space] Print Row
   [b] Bucket Stats   - Display N-bucket replay buffer statistics

====================================================================================================
‚ö† No existing model found, starting fresh
KeyboardHandler: Using termios/tty for linux.
SocketServer listening on 0.0.0.0:9999
Starting keyboard input handler thread...
Starting stats reporter thread...
      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[2J[H      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     39,232  1430.6       50%       50%      3168       135      3168      1067      1067      1067     0.000   1.999114   16.4%    744.7   17.0 0005   4.5    0.53    163496    159.7   47.630 46.630 [-14.4,47.5]  39k/4796/6%/1%/3%
[2J[H      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     51,272  1475.4       50%       50%      3144       212      3144       589       968       968 -39714.925   2.179224   22.6%    924.7   12.4 0005   6.4    0.45    183901    179.6   19.692 18.692 [-19.8,58.0]  51k/6290/8%/2%/4%
     82,488  1425.3       50%       50%      2796      -145      2796       716       867       867 -5662.993   2.253774   26.3%    737.2   12.6 0005   4.7    0.44    185156    180.8   32.240 31.240 [-25.3,72.5] 82k/10219/13%/3%/6%
    125,352  1397.8       50%       50%      3021       -10      3021       660       797       797 -2773.965   2.406790   29.7%    796.1   12.6 0005   5.2    0.45    183589    179.3   28.472 27.472 [-33.9,96.5] 125k/15605/19%/5%/10%
    168,344  1446.5       50%       50%      3011        14      3011       543       734       734 -2479.577   2.587224   31.7%    807.9   12.5 0005   5.9    0.45    183016    178.7   44.451 43.451 [-38.6,100.8] 168k/20973/25%/6%/13%
    211,384  1438.9       50%       50%      2743        79      2743       314       649       649 -2939.858   2.751435   32.6%    821.6   12.5 0005   5.1    0.46    182981    178.7   38.445 37.445 [-36.3,97.7] 211k/26339/32%/8%/16%
    254,144  1392.9       50%       50%      3286        46      3286       794       673       673 -1249.604   2.780634   33.2%    783.9   12.7 0005   5.4    0.45    184434    180.1   47.252 46.252 [-41.5,104.9] 253k/31747/38%/10%/20%
    297,024  1454.6       50%       50%      2920        50      2920       611       664       664  -919.973   2.740167   33.6%    855.7   12.5 0005   5.4    0.45    183041    178.8   55.754 54.754 [-43.7,167.2] 296k/37114/45%/11%/23%
    340,016  1415.4       50%       50%      3443        22      3443      1121       720       720   964.632   2.665077   34.1%    786.5   12.7 0005   5.6    0.44    185297    181.0   33.686 32.686 [-45.7,132.9] 339k/42547/51%/13%/26%
    382,840  1460.7       50%       50%      3355        87      3355      1137       767       767  1645.208   2.635688   34.4%    829.0   12.5 0005   5.7    0.46    182845    178.6   47.176 46.176 [-47.1,120.4] 382k/47915/58%/15%/29%
    425,680  1416.3       50%       50%      3127       123      3127       841       774       774  1796.767   1.539234   25.5%    811.9   15.3 0005   5.6    0.47    222631    217.4   25.331 24.331 [-20.3,75.8] 425k/54446/64%/17%/33%
    468,256  1428.8       50%       50%      2982       508      2982       705       767       767  1474.778   0.413997   12.8%    798.2   17.2 0005   5.4    0.48    248911    243.1    7.004  6.004 [-10.3,33.0] 467k/61746/71%/18%/36%
    510,432  1292.3       25%       25%      2705       723      2705       697       762       762   821.626   0.160151   10.3%    813.1   17.0 0005   5.1    0.51    243906    238.2    1.850  0.850 [-9.4,133.1] 509k/68900/76%/20%/39%
    570,064  2778.1       25%       25%       877      1146       877      -184       672       672 -2255.216   0.091573   10.5%    841.2    8.4 0013   3.2    1.18    171142    167.1    1.970  0.970  [-1.8,14.1] 569k/73920/81%/22%/44%
    654,480  3038.8       25%       25%       673      1291       673      -346       552       552 -3772.647   0.061645   11.7%    900.4    2.5 0016   3.3    2.01     72939     71.2    1.802  0.802 [-0.5,103.8] 653k/76060/88%/25%/50%
    742,752  3028.0       25%       25%       739      1369       739      -121       476       476 -4007.726   0.059051   12.7%    870.1    2.1 0016   3.3    2.14     62871     61.4    0.702  0.000  [-0.1,19.4] 741k/77905/95%/28%/57%
    830,552  2931.5       25%       25%       974      1179       974        31       430       430 -2852.705   0.053422   12.9%    845.4    2.1 0016   3.5    2.17     62221     60.8    1.161  0.161  [-0.3,11.2] 829k/79731/100%/32%/64%
    919,808  2990.2       25%       25%       402      1142       402      -422       352       352 -2285.390   0.051024   13.5%    887.5    2.2 0016   3.3    2.08     65746     64.2    1.673  0.673  [-0.2,11.4] 918k/81660/100%/35%/71%
  1,007,600  2509.4       10%       10%       754       871       754      -240       303       303 -1579.091   0.045840   13.7%    872.1    2.1 0016   3.4    2.15     63041     61.6    2.088  1.088  [-0.0,11.9] 1006k/83510/100%/39%/77%
  1,086,424  2596.6       10%       10%      -365      1114      -365      -738       178       230 -1415.543   0.039413   13.8%    894.3    2.0 0016   3.0    2.48     54950     53.7    0.463  0.000   [0.0,18.3] 1085k/85123/100%/42%/83%

Expert ratio: 15% (manual override)
  1,119,752  2674.8       10%       15%      -147       912      -147      -414       144       212  -639.148   0.038308   14.2%    916.4    2.1 0016   2.8    2.49     56894     55.6    0.363  0.000    [0.1,8.8] 1118k/85830/100%/43%/86%

Expert ratio: 20% (manual override)
  1,120,024  2674.8       10%       20%      -492       845      -492      -680       144       212  -929.538   0.030379   13.7%      0.0    2.0 0016   3.0    2.13     59216     57.8    0.476  0.000  [-0.1,11.1] 1118k/85836/100%/43%/86%

Expert ratio: 25% (manual override)
  1,120,328  2674.8       10%       25%      -492       845      -492      -680       144       212 -1585.500   0.044544   14.3%      0.0    2.3 0016   3.1    2.18     68965     67.3    0.417  0.000  [-0.1,13.6] 1118k/85843/100%/43%/86%

Expert ratio: 30% (manual override)
  1,120,640  2674.8       10%       30%      -492       845      -492      -680       144       212 -2026.872   0.039813   14.3%      0.0    2.4 0016   3.1    2.27     66816     65.3    0.308  0.000  [-0.1,12.1] 1119k/85850/100%/43%/86%

Expert ratio: 35% (manual override)
  1,121,280  2674.8       10%       35%      -492       845      -492      -680       144       212 -1545.248   0.022439   14.5%      0.0    2.2 0016   3.1    1.92     70335     68.7    2.484  1.484   [0.0,11.0] 1119k/85864/100%/43%/86%

Expert ratio: 40% (manual override)
  1,123,584  2902.2       10%       40%      -844      1069      -844     -1560       132       204 -4846.491   0.047077   14.4%    980.7    2.4 0016   3.1    1.69     79684     77.8    0.493  0.000  [-0.0,20.5] 1122k/85919/100%/43%/86%
  1,174,472  3054.8       10%       40%      2369       367      2369       782       140       230 18829.262   0.035822   13.4%    804.3    2.3 0016   3.8    1.99     73216     71.5    0.420  0.000  [-0.0,10.5] 1173k/87070/100%/45%/90%
Error handling client 13: Failed to read length
Error handling client 14: Failed to read length
Error handling client 15: Failed to read length
Error handling client 8: Failed to read length
Error handling client 10: Failed to read length
Error handling client 9: Failed to read length
Error handling client 7: Failed to read length
Error handling client 12: Failed to read length
[2J[H      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      Frame     FPS      Epsi      Xprt      Rwrd      Subj       Obj       DQN     DQN1M     DQN5M  DQNTrend       Loss  Agree% AvgEpLen Train% Clnt  Levl  AvgInf    Samp/s  Steps/s GradNorm  ClipŒî      Q-Range                      Stats
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1,245,280  2082.8       10%       40%      1739       384      1739       218       125       229 10323.347   0.034838   12.8%    827.2    4.0 0008   4.1    1.62    115582    112.9    0.594  0.000  [-0.1,10.6] 1243k/89868/100%/48%/96%
  1,256,064  2060.1        5%       40%      2239       341      2239       723       124       234 10883.416   0.033119   12.1%    786.0    9.8 0008   4.3    0.66    205572    200.8    0.617  0.000  [-0.0,10.0] 1254k/90923/100%/48%/97%
  1,318,088  2028.2        5%       40%      1827       630      1827        90        74       227  6918.003   0.039283   11.2%    885.6    9.6 0008   4.2    0.67    201949    197.2    0.924  0.000 [-0.1,500.0] 1300k/96845/100%/51%/100%
  1,379,856  2074.6        5%       40%      1944       502      1944       184        21       225  4657.141   0.034657   10.7%    834.9    9.4 0008   4.1    0.69    197782    193.1    1.075  0.075  [-0.0,69.8] 1300k/102645/100%/53%/100%
  1,441,904  2119.6        5%       40%      1479       493      1479       -80       -43       213  2558.351   0.036145   10.1%    877.2    9.4 0008   4.0    0.68    199304    194.6    1.022  0.022 [-0.0,500.0] 1300k/108490/100%/55%/100%
  1,503,288  1996.1        5%       40%      1979      1048      1979       382       -64       220  1770.843   0.032405    9.4%    861.6    9.3 0008   4.1    0.71    193909    189.4    2.348  1.348   [-0.1,7.8] 1300k/114176/100%/57%/100%
  1,564,728  2052.4        5%       40%      1875       950      1875       121       -86       216 -1337.918   0.037013    9.6%    825.6    9.2 0008   4.3    0.72    192801    188.3    0.330  0.000   [-0.3,7.1] 1300k/119830/100%/60%/100%
  1,626,296  2030.9        5%       40%      1802       893      1802        39       -81       209  -801.691   0.034901    9.9%    872.5    9.3 0008   4.2    0.70    194657    190.1    0.259  0.000 [-0.1,500.0] 1300k/125539/100%/62%/100%
  1,688,000  1981.6        5%       40%      1571       341      1571       -41       -45       199 -1029.854   0.029806   10.2%    805.3    9.5 0008   3.9    0.68    199129    194.5    0.201  0.000   [-0.1,3.7] 1300k/131379/100%/64%/100%
Error handling client 0: Failed to read length
Error handling client 5: Failed to read length
Error handling client 11: Failed to read length
Error handling client 6: Failed to read length
Error handling client 4: Failed to read length
Error handling client 3: Failed to read length
Error handling client 1: Failed to read length
Error handling client 2: Failed to read length
  1,695,912  1085.1        5%       40%      2491       327      2491       351       -44       200    92.332   0.023968   10.0%    857.7   57.7 0000   4.7    0.56    304502    297.4    0.577  0.000   [-0.1,5.0] 1300k/140308/100%/65%/100%
  1,695,912  1085.1        5%       40%      2230       546      2230       309       -44       200   227.921   0.026374   10.2%      0.0  100.0 0000   4.0    0.00    322119    314.6    0.262  0.000  [-0.1,53.8] 1300k/142355/100%/65%/100%
Quit command received, shutting down...
Flushing async replay buffer...
Async buffer stats: 1,693,905 processed, 0 remaining, 0 dropped
Flushing async replay buffer...
Async buffer stats: 1,693,905 processed, 0 remaining, 0 dropped
Server stopped running, exiting stats reporter
Final model state saved
Flushing async replay buffer...
Async buffer stats: 1,693,905 processed, 0 remaining, 0 dropped
Application shutdown complete
